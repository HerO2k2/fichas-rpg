<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>FICHA DE PERSONAGEM ‚Äî ARQUIVO CONFIDENCIAL</title>

<link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">

<style>
body{
    background: radial-gradient(circle at top, #1a1f2e 0%, #0b0e16 55%, #05070c 100%);
    color:#d8dcec;
    font-family:'VT323', monospace;
    margin:20px;
    font-size:20px;
}

h1,h2{
    color:#9da8ff;
    border-bottom:2px solid #3c4270;
    margin-top:30px;
    text-shadow:0 0 6px rgba(120,130,255,.4);
}

.section{
    background:linear-gradient(135deg,#0f1322,#0a0d18);
    padding:15px;
    border:2px solid #2f3563;
    margin-bottom:20px;
    box-shadow: inset 0 0 25px rgba(0,0,0,.9), 0 0 12px rgba(70,80,160,.25);
}

input, textarea{
    background:#0a0e1b;
    color:#e6ebff;
    border:2px solid #3c4270;
    padding:4px;
    font-family:'VT323', monospace;
    font-size:18px;
}

.inline{
    display:flex;
    gap:10px;
    margin-bottom: 5px;
}

.status-grid{
    display:grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap:12px;
    align-items: start;
}

.stat{ text-align:center; margin-bottom: 15px; }
.stat input{ width:45px; text-align:center; }

.fraction-container {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 4px;
    font-size: 22px;
}

/* CORES PERSONALIZADAS */
.pv{color:#ff5b5b;}
.es{color:#4b86ff;} /* Azul */
.pe{color:#2e7d32;} /* Verde Escuro */
.for{color:#ff8c00;} /* Laranja */
.agi{color:#4bff9a;}
.int{color:#80d8ff;} /* Azul Claro */
.pre{color:#c78cff;}

/* BARRAS */
.bar{ height:14px; background:#0a0d18; border:1px solid #3c4270; margin-bottom:6px; }
.bar span{ display:block; height:100%; width:0; }
.bar-for span{ background:#ff8c00; }
.bar-agi span{ background:#4bff9a; }
.bar-int span{ background:#80d8ff; }
.bar-pre span{ background:#c78cff; }

/* PER√çCIAS */
.pericias-grid{ display:grid; gap:25px; }
.pericias-row{ display:grid; grid-template-columns:1fr 1fr; gap:30px; }
.pericia{
    display:flex; justify-content:space-between; align-items:center;
    border-bottom:1px dotted #3c4270; gap:8px;
}
.pericia .nome{ flex:1; }
.pericia input{ width:60px; text-align:center; }

.desvantagem{ color:#ff4b4b; font-weight:bold; white-space: nowrap; }
textarea{ width: 100%; min-height:140px; box-sizing: border-box; }

.defesas-grid{ display:grid; grid-template-columns: repeat(2,1fr); gap:15px; }
.defesa{ text-align:center; }
.defesa input{ width:70px; text-align:center; }

.def-forca{color:#ff8c00;}
.def-aguia{color:#4bff9a;}
.def-fogo{color:#ff7f50;}
.def-oculto{color:#c78cff;}
.def-ritual{color:#4bffef;}
.def-perf{color:#ffffff;}
</style>
</head>

<body>

<h1>üìÅ FICHA DE PERSONAGEM ‚Äî ACESSO RESTRITO</h1>

<div class="section">
    <h2>Perfil</h2>
    <label>N√≠vel <input data-save></label>
    <label>Ancestral <input data-save></label>
    <label>Profiss√£o <input data-save></label>
</div>

<div class="section">
    <h2>Caracter√≠sticas</h2>
    <div class="inline">
        <label>Nome <input data-save></label>
        <label>Idade <input data-save></label>
    </div>
    <div class="inline">
        <label>Altura <input data-save></label>
        <label>Peso <input data-save></label>
    </div>
    <div class="inline">
        <label>Nacionalidade <input data-save></label>
        <label>Nascido <input data-save></label>
    </div>
</div>

<div class="section">
<h2>Status</h2>
<div class="status-grid">
  <div>
    <div class="stat pv">‚ù§Ô∏è PV<br>
        <div class="fraction-container">
            <input type="number" min="0" max="999" data-save class="cur-val">/
            <input type="number" min="0" max="999" data-save class="max-val">
        </div>
    </div>
    <div class="stat es">üõ°Ô∏è ES<br>
        <div class="fraction-container">
            <input type="number" min="0" max="999" data-save class="cur-val">/
            <input type="number" min="0" max="999" data-save class="max-val">
        </div>
    </div>
    <div class="stat pe">üîã PE<br>
        <div class="fraction-container">
            <input type="number" id="input-pe-cur" min="0" max="999" data-save class="cur-val">/
            <input type="number" id="input-pe-max" min="0" max="999" data-save class="max-val">
        </div>
    </div>
  </div>

  <div>
    <div class="stat for">üí™ FOR<br><input type="number" id="attr-for" min="0" max="5" data-save data-bar="for"></div>
    <div class="stat agi">üèÉ AGI<br><input type="number" id="attr-agi" min="0" max="5" data-save data-bar="agi"></div>
  </div>

  <div>
    <div class="stat int">üß† INT<br><input type="number" id="attr-int" min="0" max="5" data-save data-bar="int"></div>
    <div class="stat pre">üéØ PRE<br><input type="number" id="attr-pre" min="0" max="5" data-save data-bar="pre"></div>
  </div>
</div>

<h3>Distribui√ß√£o de Atributos</h3>
<div id="bars"></div>
</div>

<div class="section">
<h2>Defesas</h2>
<div class="defesas-grid">
  <div>
    <div class="defesa def-forca">üëä Impacto<br><input type="number" id="def-impacto" min="0" max="20" data-save></div>
    <div class="defesa def-perf">üèπ Perfura√ß√£o<br><input type="number" id="def-perfuracao" min="0" max="20" data-save></div>
    <div class="defesa def-aguia">‚öîÔ∏è Corte<br><input type="number" id="def-corte" min="0" max="20" data-save></div>
  </div>
  <div>
    <div class="defesa def-fogo">üî• Queimadura<br><input type="number" id="def-queimadura" min="0" max="20" data-save></div>
    <div class="defesa def-oculto">üëÅÔ∏è Ocultismo<br><input type="number" id="def-ocultismo" min="0" max="20" data-save></div>
    <div class="defesa def-ritual">üå≥ Ritual<br><input type="number" id="def-ritual" min="0" max="20" data-save></div>
  </div>
</div>
</div>

<div class="section">
<h2>Per√≠cias</h2>
<div class="pericias-grid">
<div class="pericias-row">
    <div>
        <div class="pericia for"><span class="nome">FORTITUDE (FOR)</span><input data-save></div>
        <div class="pericia for"><span class="nome">LUTA (FOR)</span><input data-save></div>
        <div class="pericia for"><span class="nome">ATLETISMO (FOR)</span><input data-save></div>
        <div class="pericia for"><span class="nome">ARREMESSO (FOR)</span><input data-save></div>
        <div class="pericia for"><span class="nome">T√ÅTICA (FOR)</span><input data-save></div>
        <div class="pericia for"><span class="nome">IMPOSI√á√ÉO (FOR)</span><input data-save></div>

        <div class="pericia pre"><span class="nome">VONTADE (PRE)</span><input data-save></div>
        <div class="pericia pre"><span class="nome">ADESTRAMENTO (PRE)</span><input data-save></div>
        <div class="pericia pre"><span class="nome">INTIMIDA√á√ÉO (PRE)</span><input data-save></div>
        <div class="pericia pre"><span class="nome">PERSUAS√ÉO (PRE)</span><input data-save></div>
        <div class="pericia pre"><span class="nome">ENGANA√á√ÉO (PRE)</span><input data-save></div>
        <div class="pericia pre"><span class="nome">ATUA√á√ÉO (PRE)</span><input data-save></div>
        <div class="pericia pre"><span class="nome">FANATISMO (PRE)</span><input data-save></div>
        <div class="pericia pre"><span class="nome">COMPOSTURA (PRE)</span><input data-save></div>
        <div class="pericia pre"><span class="nome">AUTORIDADE (PRE)</span><input data-save></div>
        <div class="pericia pre"><span class="nome">ETIQUETA (PRE)</span><input data-save></div>
    </div>
    
    <div>
        <div class="pericia agi"><span class="nome">CORTE (AGI)</span><input data-save></div>
        <div class="pericia agi"><span class="nome">ACROBACIA (AGI)</span><input data-save></div>
        <div class="pericia agi"><span class="nome">PONTARIA (AGI)</span><input data-save></div>
        <div class="pericia agi"><span class="nome">SOBREVIV√äNCIA (AGI)</span><input data-save></div>
        <div class="pericia agi"><span class="nome">REFLEXO (AGI)</span><input data-save></div>
        <div class="pericia agi"><span class="nome">FURTIVIDADE (AGI)</span><input data-save></div>

        <div class="pericia int"><span class="nome">ARTES (INT)</span><input data-save></div>
        <div class="pericia int"><span class="nome">CI√äNCIAS (INT)</span><input data-save></div>
        <div class="pericia int"><span class="nome">PERCEP√á√ÉO (INT)</span><input data-save></div>
        <div class="pericia int"><span class="nome">RITUAL (INT)</span><input data-save></div>
        <div class="pericia int"><span class="nome">OCULTISMO (INT)</span><input data-save></div>
        <div class="pericia int"><span class="nome">RELIGI√ÉO (INT)</span><input data-save></div>
        <div class="pericia int"><span class="nome">PESQUISA (INT)</span><input data-save></div>
        <div class="pericia int"><span class="nome">MEDICINA (INT)</span><input data-save></div>
        <div class="pericia int"><span class="nome">DIRE√á√ÉO (INT)</span><input data-save></div>
        <div class="pericia int"><span class="nome">ATUALIDADES (INT)</span><input data-save></div>
    </div>
</div>
</div>
</div>

<div class="section">
    <h2>Invent√°rio</h2>
    <textarea data-save placeholder="Descreva seus itens aqui..."></textarea>
</div>

<script>
const inputs = document.querySelectorAll("[data-save]");
const bars = document.getElementById("bars");

let valoresAntigos = { "attr-for": 0, "attr-agi": 0, "attr-int": 0 };

inputs.forEach((el, i) => {
    const k = "ficha_" + i;
    const savedValue = localStorage.getItem(k);
    if (savedValue !== null) el.value = savedValue;

    if (valoresAntigos.hasOwnProperty(el.id)) {
        valoresAntigos[el.id] = Number(el.value) || 0;
    }

    el.oninput = () => {
        // Trava Atual <= M√°ximo
        if (el.classList.contains("cur-val")) {
            const container = el.closest('.fraction-container');
            const maxVal = Number(container.querySelector('.max-val').value) || 0;
            if (Number(el.value) > maxVal) el.value = maxVal;
        }

        // B√¥nus de Defesa
        if (valoresAntigos.hasOwnProperty(el.id)) {
            const novoValor = Number(el.value) || 0;
            const diff = novoValor - valoresAntigos[el.id];
            if (diff !== 0) {
                aplicarBonusDefesa(el.id, diff);
                valoresAntigos[el.id] = novoValor;
            }
        }

        localStorage.setItem(k, el.value);
        renderBars();
        aplicarDesvantagem();
    };
});

function aplicarBonusDefesa(attrId, diff) {
    let defs = [];
    if (attrId === "attr-for") defs = ["def-impacto", "def-perfuracao"];
    if (attrId === "attr-agi") defs = ["def-corte", "def-queimadura"];
    if (attrId === "attr-int") defs = ["def-ocultismo", "def-ritual"];

    defs.forEach(id => {
        const inputDef = document.getElementById(id);
        if (!inputDef) return;
        let novo = Math.min(20, Math.max(0, (Number(inputDef.value) || 0) + diff));
        inputDef.value = novo;
        // Salva o estado da defesa alterada
        inputs.forEach((inp, idx) => { if(inp.id === id) localStorage.setItem("ficha_"+idx, novo); });
    });
}

function renderBars() {
    bars.innerHTML = "";
    document.querySelectorAll("[data-bar]").forEach(el => {
        let v = Math.min(5, Math.max(0, el.value || 0));
        let b = document.createElement("div");
        b.className = "bar bar-" + el.dataset.bar;
        b.innerHTML = `<span style="width:${v * 20}%"></span>`;
        bars.appendChild(b);
    });
}

function aplicarDesvantagem() {
    const vals = {
        for: Number(document.getElementById("attr-for").value) || 0,
        agi: Number(document.getElementById("attr-agi").value) || 0,
        int: Number(document.getElementById("attr-int").value) || 0,
        pre: Number(document.getElementById("attr-pre").value) || 0,
        pe: Number(document.getElementById("input-pe-cur").value) || 0
    };

    document.querySelectorAll(".pericia").forEach(p => {
        p.querySelectorAll(".desvantagem").forEach(d => d.remove());
        let m = p.classList;
        if (vals.pe === 0 || (m.contains("for") && vals.for === 0) || (m.contains("agi") && vals.agi === 0) || (m.contains("int") && vals.int === 0) || (m.contains("pre") && vals.pre === 0)) {
            let s = document.createElement("span"); s.className = "desvantagem"; s.textContent = "Desvantagem";
            p.insertBefore(s, p.querySelector("input"));
        }
    });
}

renderBars();
aplicarDesvantagem();
</script>
</body>
</html>
